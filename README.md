# CupIT2023-DS-Lagers
Решение команды Lagers для кейс-чемпионата Cup IT DS
Добрый день!
Здесь представлена последовательность действий, чтобы получить файлы необходимые для анализа и запуска моделей.
Все файлы, которые необходимы для запуска моделей и скриптов уже загружены в текущую директорию 
(В GitHub репозитории нет 2 файлов, все файлы отправлены в zip архиве на сайте  Changellenge)

Конечные результаты находятся в папке Predictions

1. Запустить ноутбук main.ipynb и Embeddings_train.ipynb для получения сложных фичей	
	При отработке скриптов получим файлы:
		cos_sim.txt - косинусное расстояние между текстом поста и комментарием
		pos_neg_features - оценка позитивности комментария для тренировочных данных
		pos_neg_test_features - оценка позитивности комментария для тестовых данных

2. Запустить ноутбук feature_creation.ipynb для того, чтобы получить остальные фичи и объединить их с фичами из пункта 1
	dataset_train.csv - датасет после отработки 

3. Запустить ноутбук Toxic, где создаются sentiment features. Добавляются к остальному датасету
	dataset_toxic_cos_pn.csv - датасет после отработки
	
3. Запустить ноутбук Analys, в котором можно увидеть исследовательский анализ данных

4. Запустить ноутбуки с разными моделями и их оценкой эффективности
	NN_model.ipynb - Полносвязная нейронная сеть
	Ranker.ipynb - XGBRanker
	CatBoost_stack_NN.ipynb - Stacking CatBoost и NN

	Catboost.ipynb  - Модель, которую мы выбрали для обучения (с валидацией)

	Catboost_for_all.ipynb - Обучение выбранной модели на всех данных и сохранение обученной модели
	CatBoost.pkl - обученная модель

5. Обработаем тестовый датасет по аналогии с тренировочным
   Запустить ноутбук Embeddings_test.ipynb для получения сложных фичей	
	При отработке скрипта получим файл:
		cos_sim_test.txt - косинусное расстояние между текстом поста и комментарием
		
		
6. Запустить ноутбук Feature_creation_and_predict_test.ipynb в котором происходит конечная обработка датасета,
применяется обученная модель и сохраняется результат:
	ranking_test_answers.jsonl - Файл как в начале, только с заполненным score
	ranking_test_answers.txt - Упорядоченные значения предсказаний (запасной файл)

Ссылка на GitHub с ноутбукамии
https://github.com/Radmayr/CupIT2023-DS-Lagers
